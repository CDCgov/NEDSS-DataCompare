name: Build and push data-compare services images to ECR
on:
  push:
    branches:
      - main
      - master
      - rel-**
    paths-ignore:
      - "docker-compose.yml"
      - "**.md"
jobs:
  call-build-microservice-container-workflow:
    name: Build Container
    uses: CDCgov/NEDSS-Workflows/.github/workflows/Build-gradle-microservice-container.yaml@ph/APP-145-push-to-ecr
    with:
      microservice_name: nbs7-data-compare-api-service
      dockerfile_relative_path: -f ./DataCompareAPIs/Dockerfile .
      environment_classifier: SNAPSHOT
      java_version: "21"
    secrets:
      NBS_ACCOUNTID: ${{secrets.NBS_ACCOUNTID}}

  call-build-data-compare-processor-microservice-container-workflow:
    name: Build Container
    uses: CDCgov/NEDSS-Workflows/.github/workflows/Build-gradle-microservice-container.yaml@ph/APP-145-push-to-ecr
    with:
      microservice_name: nbs7-data-compare-processor-service
      dockerfile_relative_path: -f ./DataCompareProcessor/Dockerfile .
      environment_classifier: SNAPSHOT
      java_version: "21"
    secrets:
      NBS_ACCOUNTID: ${{secrets.NBS_ACCOUNTID}}

